{"version":3,"file":"hug-angular-lib.umd.js","sources":["../node_modules/tslib/tslib.es6.js","ng://hug-angular-lib/lib/hug-angular-lib.component.ts","ng://hug-angular-lib/lib/log.service.ts","ng://hug-angular-lib/lib/hug-angular-lib.module.ts","ng://hug-angular-lib/lib/stream.ts","ng://hug-angular-lib/lib/signaling.service.ts","ng://hug-angular-lib/lib/peer.ts","ng://hug-angular-lib/lib/remote-peers.service.ts","ng://hug-angular-lib/lib/room.service.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from) {\r\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\r\n        to[j] = from[i];\r\n    return to;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'lib-hug-angular-lib',\n  template: `\n    <p>\n      hug-fuck shit address\n    </p>\n  `,\n  styles: []\n})\nexport class HugAngularLibComponent implements OnInit {\n\n  constructor() { }\n\n  ngOnInit(): void {\n\n  }\n\n}\n","// import { Injectable } from '@angular/core';\nexport { NGXLogger as LogService } from 'ngx-logger';\n\n// @Injectable({\n//   providedIn: 'root'\n// })\n// export class LogService extends NGXLogger {\n\n//   constructor() {\n//     super()\n//   }\n// }\n","import { LogService } from './log.service';\nimport { NgModule } from '@angular/core';\nimport { HugAngularLibComponent } from './hug-angular-lib.component';\nimport { LoggerModule, NgxLoggerLevel } from 'ngx-logger';\n\nconsole.log('NGX logger')\n@NgModule({\n  declarations: [HugAngularLibComponent],\n  imports: [\n    LoggerModule.forRoot({ level: NgxLoggerLevel.DEBUG})\n  ],\n  providers:[LogService],\n  exports: [HugAngularLibComponent]\n})\nexport class HugAngularLibModule { }\n","import { Subject } from 'rxjs';\n\n\nimport * as mediasoup from 'mediasoup-client';\n\nimport { Peer } from './peer';\n\n\nexport class Stream {\n\n  public consumer?: mediasoup.types.Consumer;\n  public peer?: Peer;\n  public producer?\n  public streamId: string;\n\n  public onLayerChange: Subject<any> = new Subject()\n\n  public type;\n  public producerPaused: boolean\n\n  public kind;\n\n  mediaStream: MediaStream = new MediaStream();\n\n  setConsumer(consumer: mediasoup.types.Consumer) {\n    this.consumer = consumer;\n    this.streamId = consumer.id\n    this.kind = consumer.kind;\n    this.mediaStream.addTrack(consumer.track);\n  }\n\n  consumerLayerChanged() {\n    this.mediaStream = new MediaStream();\n    this.mediaStream.addTrack(this.consumer.track);\n    this.onLayerChange.next()\n  }\n\n\n  setProducer(producer) {\n    this.producer = producer\n    this.mediaStream.addTrack(producer.track);\n  }\n}\n","import { LogService } from './log.service';\nimport { Injectable } from '@angular/core';\n\n\nimport { io, Socket } from 'socket.io-client';\nimport { Subject } from 'rxjs';\n\n\nconst requestTimeout = 20000\n\n/**\n * Error produced when a socket request has a timeout.\n */\nexport class SocketTimeoutError extends Error\n{\n\tconstructor(message)\n\t{\n\t\tsuper(message);\n\n\t\tthis.name = 'SocketTimeoutError';\n\n    if (Error.hasOwnProperty('captureStackTrace')) // Just in V8.\n      // @ts-ignore\n\t\t\tError.captureStackTrace(this, SocketTimeoutError);\n\t\telse\n\t\t\tthis.stack = (new Error(message)).stack;\n\t}\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class SignalingService  {\n\n  peerId: string;\n  roomId: string;\n  _signalingSocket: Socket;\n  _signalingBaseUrl = 'wss://conferences.iabsis.com';\n  _signalingUrl: string;\n  _closed = false;\n\n  onDisconnected: Subject<any> = new Subject()\n  onReconnecting: Subject<any> = new Subject()\n  onReconnected: Subject<any> = new Subject()\n  onNewConsumer: Subject<any> = new Subject();\n  onNotification: Subject<any> = new Subject();\n  constructor(private logger: LogService ) {\n\n   }\n\n\n  init(roomId, peerId) {\n\n    this._signalingUrl =\n    `${this._signalingBaseUrl}/?roomId=${roomId}&peerId=${peerId}`;\n    this._signalingSocket = io(this._signalingUrl)\n    this.logger.debug(\"Initialize socket \", this._signalingUrl)\n\n\n\t\tthis._signalingSocket.on('connect', () =>\n\t\t{\n\t\t \tthis.logger.debug('signaling Peer \"connect\" event');\n    });\n\n    this._signalingSocket.on('disconnect', (reason) =>\n\t\t{\n\t\t\tthis.logger.warn('signaling Peer \"disconnect\" event [reason:\"%s\"]', reason);\n\n\t\t\tif (this._closed)\n\t\t\t\treturn;\n\n\t\t\tif (reason === 'io server disconnect')\n\t\t\t{\n        this.onDisconnected.next()\n\n\t\t\t\tthis.close();\n\t\t\t}\n\n      this.onReconnecting.next\n\n\t\t});\n\n    this._signalingSocket.on('reconnect_failed', () =>\n\t\t{\n\t\t\tthis.logger.warn('signaling Peer \"reconnect_failed\" event');\n\n      this.onDisconnected.next()\n\n\t\t\tthis.close();\n    });\n\n\n\t\tthis._signalingSocket.on('reconnect', (attemptNumber) =>\n\t\t{\n\t\t\tthis.logger.debug('signaling Peer \"reconnect\" event [attempts:\"%s\"]', attemptNumber);\n\n      this.onReconnected.next(attemptNumber)\n\n\n\t\t\t// store.dispatch(roomActions.setRoomState('connected'));\n\t\t});\n\n\n\n\t\tthis._signalingSocket.on('request', async (request, cb) =>\n\t\t{\n\t\t\tthis.logger.debug(\n\t\t\t\t'socket \"request\" event [method:\"%s\", data:\"%o\"]',\n\t\t\t\trequest.method, request.data);\n\n\n\t\t\tswitch (request.method)\n\t\t\t{\n\t\t\t\tcase 'newConsumer':\n\t\t\t\t{\n            this.onNewConsumer.next(request.data);\n            cb()\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tdefault:\n\t\t\t\t{\n\t\t\t\t\tthis.logger.error('unknown request.method \"%s\"', request.method);\n\n\t\t\t\t\tcb(500, `unknown request.method \"${request.method}\"`);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n    this._signalingSocket.on('notification', (notification) => {\n      this.logger.debug(\n        'socket \"notification\" event [method:\"%s\", data:\"%o\"]',\n        notification.method, notification.data);\n\n      this.onNotification.next(notification)\n\n    });\n\n\n\n  }\n  close() {\n    if (this._closed)\n      return;\n\n    this._closed = true;\n\n    this.logger.debug('close()');\n\n    this._signalingSocket.close();\n\n\n  }\n\ttimeoutCallback(callback)\n\t{\n\t\tlet called = false;\n\n\t\tconst interval = setTimeout(\n\t\t\t() =>\n\t\t\t{\n\t\t\t\tif (called)\n\t\t\t\t\treturn;\n\t\t\t\tcalled = true;\n\t\t\t\tcallback(new SocketTimeoutError('Request timed out'));\n\t\t\t},\n\t\t\trequestTimeout\n\t\t);\n\n\t\treturn (...args) =>\n\t\t{\n\t\t\tif (called)\n\t\t\t\treturn;\n\t\t\tcalled = true;\n\t\t\tclearTimeout(interval);\n\n\t\t\tcallback(...args);\n\t\t};\n\t}\n\n\t_sendRequest(method, data)\n\t{\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tif (!this._signalingSocket)\n\t\t\t{\n\t\t\t\treject('No socket connection');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis._signalingSocket.emit(\n\t\t\t\t\t'request',\n\t\t\t\t\t{ method, data },\n\t\t\t\t\tthis.timeoutCallback((err, response) =>\n\t\t\t\t\t{\n\t\t\t\t\t\tif (err)\n\t\t\t\t\t\t\treject(err);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tresolve(response);\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t});\n  }\n\n\n\tpublic async sendRequest(method, data?):Promise<any>\n\t{\n\t\tthis.logger.debug('sendRequest() [method:\"%s\", data:\"%o\"]', method, data);\n\n\t\tconst requestRetries = 3\n\n\n\t\tfor (let tries = 0; tries < requestRetries; tries++)\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\treturn await this._sendRequest(method, data);\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\terror instanceof SocketTimeoutError &&\n\t\t\t\t\ttries < requestRetries\n\t\t\t\t)\n\t\t\t\t\tthis.logger.warn('sendRequest() | timeout, retrying [attempt:\"%s\"]', tries);\n\t\t\t\telse\n\t\t\t\t\tthrow error;\n\t\t\t}\n\t\t}\n\t}\n\n}\n","import { Stream } from './stream';\nexport class Peer {\n  id: string\n  streams: Stream[]=[]\n}\n","import { Stream } from './stream';\nimport { LogService } from './log.service';\nimport { Peer } from './peer';\nimport { Observable } from 'rxjs/internal/Observable';\nimport { Injectable } from '@angular/core';\nimport { BehaviorSubject } from 'rxjs';\nimport * as mediasoup from 'mediasoup-client';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class RemotePeersService {\n\n\tpublic remotePeers: Observable<Peer[]>;\n\tprivate _remotePeers: BehaviorSubject<Peer[]> = new BehaviorSubject([]);\n\n  private peers: Peer[] = []\n  constructor(private logger: LogService) {\n    this.remotePeers = this._remotePeers.asObservable()\n   }\n\n\n  updatePeers() {\n    setTimeout(() => \tthis._remotePeers.next(this.peers)    ,0)\n  }\n\n  clearPeers(){\n    this._remotePeers = <BehaviorSubject<Peer[]>>new BehaviorSubject([]);\n    this.remotePeers = this._remotePeers.asObservable();\n    this.peers = []\n  }\n  newPeer(id): Peer {\n    this.logger.debug('New peer', id)\n    const peer = new Peer()\n    peer.id = id;\n    peer.streams = []\n    this.addPeer(peer)\n    this.updatePeers()\n    return peer\n  }\n  closePeer(id){\n\t\tthis.logger.debug(\n\t\t\t'room \"peerClosed\" event [peerId:%o]', id);\n\n    this.peers = this.peers.filter((peer) => peer.id !== id);\n    this.updatePeers()\n  }\n\n\n  addPeer(peer: Peer) {\n    this.peers.push(peer)\n  }\n\n  addPeers(peers){\n    this.logger.debug('Add peers ', peers)\n\t\tfor (const peer of peers)\n\t\t{\n\t\t\tif (!this.peers.find(p=>peer.id === p.id))\n\t\t\t{\n\t\t\t\tthis.logger.debug('adding peer [peerId: \"%s\"]', peer.id);\n        this.peers.push({ id: peer.id, streams:[] });\n\t\t\t}\n\t\t}\n\t\tthis.updatePeers();\n  }\n\n  newConsumer(consumer: mediasoup.types.Consumer, peerId: string, type, producerPaused) {\n\n    this.logger.debug('remote peers New consumer', consumer, peerId)\n    let peer = this.peers.find(peer => peer.id === peerId)\n\n    if (!peer) {\n      this.logger.warn('Couldn\\'t find peer', peerId, this.peers)\n      peer = this.newPeer(peerId)\n    }\n    const existingStream = peer.streams.find(stream => stream.consumer?.appData.source === consumer.appData.source)\n\n    if (existingStream) {\n      existingStream.setConsumer(consumer)\n    } else {\n      const stream = new Stream()\n      stream.peer = peer\n      stream.type = type;\n      stream.producerPaused = producerPaused;\n      stream.setConsumer(consumer)\n      this.logger.debug('New stream created ', stream)\n      peer.streams.push(stream)\n    }\n\n    this.updatePeers()\n\n  }\n\n  onConsumerLayerChanged(consumerId) {\n\n\n\n      const stream = this.getStreamByConsumerId( consumerId)\n      if (stream) {\n\n        stream.consumerLayerChanged()\n      }\n\n  }\n\n\n  getStreamByConsumerId(consumerId: string): Stream {\n    for (const peer of this.peers) {\n      const stream = peer.streams.find(s => s.consumer.id === consumerId)\n      if (stream) {\n        return stream\n      }\n    }\n    return null\n  }\n}\n","import { Stream } from './stream';\nimport { RemotePeersService } from './remote-peers.service';\nimport { LogService } from './log.service';\nimport { SignalingService } from './signaling.service';\n\nimport { Injectable } from '@angular/core';\n\nimport { switchMap } from 'rxjs/operators';\nimport bowser from 'bowser';\n\nimport * as mediasoupClient from 'mediasoup-client'\nimport { Subject } from 'rxjs';\n\n\nlet saveAs;\n\n\nconst lastN = 4\nconst mobileLastN = 1\nconst videoAspectRatio = 1.777\n\nconst simulcast = true;\nconst \tsimulcastEncodings   = [\n  { scaleResolutionDownBy: 4 },\n  { scaleResolutionDownBy: 2 },\n  { scaleResolutionDownBy: 1 }\n]\n\n\nconst VIDEO_CONSTRAINS =\n{\n\t'low' :\n\t{\n\t\twidth       : { ideal: 320 },\n\t\taspectRatio : videoAspectRatio\n\t},\n\t'medium' :\n\t{\n\t\twidth       : { ideal: 640 },\n\t\taspectRatio : videoAspectRatio\n\t},\n\t'high' :\n\t{\n\t\twidth       : { ideal: 1280 },\n\t\taspectRatio : videoAspectRatio\n\t},\n\t'veryhigh' :\n\t{\n\t\twidth       : { ideal: 1920 },\n\t\taspectRatio : videoAspectRatio\n\t},\n\t'ultra' :\n\t{\n\t\twidth       : { ideal: 3840 },\n\t\taspectRatio : videoAspectRatio\n\t}\n};\n\nconst PC_PROPRIETARY_CONSTRAINTS =\n{\n\toptional : [ { googDscp: true } ]\n};\n\nconst VIDEO_SIMULCAST_ENCODINGS =\n[\n\t{ scaleResolutionDownBy: 4, maxBitRate: 100000 },\n\t{ scaleResolutionDownBy: 1, maxBitRate: 1200000 }\n];\n\n// Used for VP9 webcam video.\nconst VIDEO_KSVC_ENCODINGS =\n[\n\t{ scalabilityMode: 'S3T3_KEY' }\n];\n\n// Used for VP9 desktop sharing.\nconst VIDEO_SVC_ENCODINGS =\n[\n\t{ scalabilityMode: 'S3T3', dtx: true }\n];\n\n\n@Injectable({\n  providedIn: 'root'\n})\nexport  class RoomService {\n\n\n\n  // Transport for sending.\n  _sendTransport = null;\n  // Transport for receiving.\n  _recvTransport = null;\n\n  _closed = false;\n\n  _produce = true;\n\n  _forceTcp = false;\n\n  _muted\n  _device\n  _peerId\n  _soundAlert\n  _roomId\n  _mediasoupDevice\n\n  _micProducer\n  _hark\n  _harkStream\n  _webcamProducer\n  _extraVideoProducers\n  _webcams\n  _audioDevices\n  _audioOutputDevices\n  _consumers\n  _useSimulcast\n  _turnServers\n\n  public onCamProducing: Subject<any> = new Subject();\n  constructor(\n    private signalingService: SignalingService,\n    private logger: LogService,\n  private remotePeersService: RemotePeersService) {\n\n\n  }\n\n  init({\n    peerId=null,\n\n    produce=true,\n    forceTcp=false,\n    muted=false\n  } = {}) {\n    if (!peerId)\n      throw new Error('Missing peerId');\n\n\n    // logger.debug(\n    //   'constructor() [peerId: \"%s\", device: \"%s\", produce: \"%s\", forceTcp: \"%s\", displayName \"\"]',\n    //   peerId, device.flag, produce, forceTcp);\n\n\n\n\n    // Whether we should produce.\n    this._produce = produce;\n\n    // Whether we force TCP\n    this._forceTcp = forceTcp;\n\n\n\n\n    // Whether simulcast should be used.\n    // this._useSimulcast = false;\n\n    // if ('simulcast' in window.config)\n    //   this._useSimulcast = window.config.simulcast;\n\n\n\n\n\n    this._muted = muted;\n\n    // This device\n    this._device = this.deviceInfo();\n\n    // My peer name.\n    this._peerId = peerId;\n\n\n\n    // Alert sound\n    // this._soundAlert = new Audio('/sounds/notify.mp3');\n\n\n\n\n    // The room ID\n    this._roomId = null;\n\n    // mediasoup-client Device instance.\n    // @type {mediasoupClient.Device}\n    this._mediasoupDevice = null;\n\n\n    // Transport for sending.\n    this._sendTransport = null;\n\n    // Transport for receiving.\n    this._recvTransport = null;\n\n    // Local mic mediasoup Producer.\n    this._micProducer = null;\n\n    // Local mic hark\n    this._hark = null;\n\n    // Local MediaStream for hark\n    this._harkStream = null;\n\n    // Local webcam mediasoup Producer.\n    this._webcamProducer = null;\n\n    // Extra videos being produced\n    this._extraVideoProducers = new Map();\n\n    // Map of webcam MediaDeviceInfos indexed by deviceId.\n    // @type {Map<String, MediaDeviceInfos>}\n    this._webcams = {};\n\n    this._audioDevices = {};\n\n    this._audioOutputDevices = {};\n\n    // mediasoup Consumers.\n    // @type {Map<String, mediasoupClient.Consumer>}\n    this._consumers = new Map();\n\n    this._useSimulcast = simulcast\n\n    // this._startKeyListener();\n\n    // this._startDevicesListener();\n\n  }\n  close() {\n    if (this._closed)\n      return;\n\n    this._closed = true;\n\n    this.logger.debug('close()');\n\n    this.signalingService.close();\n\n    // Close mediasoup Transports.\n    if (this._sendTransport)\n      this._sendTransport.close();\n\n    if (this._recvTransport)\n      this._recvTransport.close();\n\n\n  }\n\n  // _startKeyListener() {\n  //   // Add keydown event listener on document\n  //   document.addEventListener('keydown', (event) => {\n  //     if (event.repeat) return;\n  //     const key = String.fromCharCode(event.which);\n\n  //     const source = event.target;\n\n  //     const exclude = ['input', 'textarea'];\n\n  //     if (exclude.indexOf(source.tagName.toLowerCase()) === -1) {\n  //       logger.debug('keyDown() [key:\"%s\"]', key);\n\n  //       switch (key) {\n\n  //         /*\n  //         case String.fromCharCode(37):\n  //         {\n  //           const newPeerId = this._spotlights.getPrevAsSelected(\n  //             store.getState().room.selectedPeerId);\n\n  //           if (newPeerId) this.setSelectedPeer(newPeerId);\n  //           break;\n  //         }\n\n  //         case String.fromCharCode(39):\n  //         {\n  //           const newPeerId = this._spotlights.getNextAsSelected(\n  //             store.getState().room.selectedPeerId);\n\n  //           if (newPeerId) this.setSelectedPeer(newPeerId);\n  //           break;\n  //         }\n  //         */\n\n\n  //         case 'M': // Toggle microphone\n  //           {\n  //             if (this._micProducer) {\n  //               if (!this._micProducer.paused) {\n  //                 this.muteMic();\n\n  //                 store.dispatch(requestActions.notify(\n  //                   {\n  //                     text: intl.formatMessage({\n  //                       id: 'devices.microphoneMute',\n  //                       defaultMessage: 'Muted your microphone'\n  //                     })\n  //                   }));\n  //               }\n  //               else {\n  //                 this.unmuteMic();\n\n  //                 store.dispatch(requestActions.notify(\n  //                   {\n  //                     text: intl.formatMessage({\n  //                       id: 'devices.microphoneUnMute',\n  //                       defaultMessage: 'Unmuted your microphone'\n  //                     })\n  //                   }));\n  //               }\n  //             }\n  //             else {\n  //               this.updateMic({ start: true });\n\n  //               store.dispatch(requestActions.notify(\n  //                 {\n  //                   text: intl.formatMessage({\n  //                     id: 'devices.microphoneEnable',\n  //                     defaultMessage: 'Enabled your microphone'\n  //                   })\n  //                 }));\n  //             }\n\n  //             break;\n  //           }\n\n  //         case 'V': // Toggle video\n  //           {\n  //             if (this._webcamProducer)\n  //               this.disableWebcam();\n  //             else\n  //               this.updateWebcam({ start: true });\n\n  //             break;\n  //           }\n\n  //         case 'H': // Open help dialog\n  //           {\n  //             store.dispatch(roomActions.setHelpOpen(true));\n\n  //             break;\n  //           }\n\n  //         default:\n  //           {\n  //             break;\n  //           }\n  //       }\n  //     }\n  //   });\n\n\n  // }\n\n  _startDevicesListener() {\n    navigator.mediaDevices.addEventListener('devicechange', async () => {\n      this.logger.debug('_startDevicesListener() | navigator.mediaDevices.ondevicechange');\n\n      await this._updateAudioDevices();\n      await this._updateWebcams();\n      await this._updateAudioOutputDevices();\n\n      // store.dispatch(requestActions.notify(\n      //   {\n      //     text: intl.formatMessage({\n      //       id: 'devices.devicesChanged',\n      //       defaultMessage: 'Your devices changed, configure your devices in the settings dialog'\n      //     })\n      //   }));\n    });\n  }\n\n\n\n  async muteMic() {\n    this.logger.debug('muteMic()');\n\n    this._micProducer.pause();\n\n    try {\n      await this.signalingService.sendRequest(\n        'pauseProducer', { producerId: this._micProducer.id });\n\n      // store.dispatch(\n      //   producerActions.setProducerPaused(this._micProducer.id));\n\n      // store.dispatch(\n      //   settingsActions.setAudioMuted(true));\n\n    }\n    catch (error) {\n      this.logger.error('muteMic() [error:\"%o\"]', error);\n\n      // store.dispatch(requestActions.notify(\n      //   {\n      //     type: 'error',\n      //     text: intl.formatMessage({\n      //       id: 'devices.microphoneMuteError',\n      //       defaultMessage: 'Unable to mute your microphone'\n      //     })\n      //   }));\n    }\n  }\n\n  async unmuteMic() {\n    this.logger.debug('unmuteMic()');\n\n    if (!this._micProducer) {\n      this.updateMic({ start: true });\n    }\n    else {\n      this._micProducer.resume();\n\n      try {\n        await this.signalingService.sendRequest(\n          'resumeProducer', { producerId: this._micProducer.id });\n\n        // store.dispatch(\n        //   producerActions.setProducerResumed(this._micProducer.id));\n\n        // store.dispatch(\n        //   settingsActions.setAudioMuted(false));\n\n      }\n      catch (error) {\n        this.logger.error('unmuteMic() [error:\"%o\"]', error);\n\n        // store.dispatch(requestActions.notify(\n        //   {\n        //     type: 'error',\n        //     text: intl.formatMessage({\n        //       id: 'devices.microphoneUnMuteError',\n        //       defaultMessage: 'Unable to unmute your microphone'\n        //     })\n        //   }));\n      }\n    }\n  }\n\n\n  async changeAudioOutputDevice(deviceId) {\n    this.logger.debug('changeAudioOutputDevice() [deviceId:\"%s\"]', deviceId);\n\n    // store.dispatch(\n    //   meActions.setAudioOutputInProgress(true));\n\n    try {\n      const device = this._audioOutputDevices[deviceId];\n\n      if (!device)\n        throw new Error('Selected audio output device no longer available');\n\n      // store.dispatch(settingsActions.setSelectedAudioOutputDevice(deviceId));\n\n      await this._updateAudioOutputDevices();\n    }\n    catch (error) {\n      this.logger.error('changeAudioOutputDevice() [error:\"%o\"]', error);\n    }\n\n    // store.dispatch(\n    //   meActions.setAudioOutputInProgress(false));\n  }\n\n  // Only Firefox supports applyConstraints to audio tracks\n  // See:\n  // https://bugs.chromium.org/p/chromium/issues/detail?id=796964\n  async updateMic({\n    start = false,\n    restart = false || this._device.flag !== 'firefox',\n    newDeviceId = null\n  } = {}) {\n    this.logger.debug(\n      'updateMic() [start:\"%s\", restart:\"%s\", newDeviceId:\"%s\"]',\n      start,\n      restart,\n      newDeviceId\n    );\n\n    let track;\n\n    try {\n      if (!this._mediasoupDevice.canProduce('audio'))\n        throw new Error('cannot produce audio');\n\n      if (newDeviceId && !restart)\n        throw new Error('changing device requires restart');\n\n      // if (newDeviceId)\n      //   store.dispatch(settingsActions.setSelectedAudioDevice(newDeviceId));\n\n      // store.dispatch(meActions.setAudioInProgress(true));\n\n      const deviceId = await this._getAudioDeviceId();\n      const device = this._audioDevices[deviceId];\n\n      if (!device)\n        throw new Error('no audio devices');\n\n      const autoGainControl = false;\n      const echoCancellation = true\n      const noiseSuppression = true\n\n      // if (!window.config.centralAudioOptions) {\n      //   throw new Error(\n      //     'Missing centralAudioOptions from app config! (See it in example config.)'\n      //   );\n      // }\n\n      const {\n        sampleRate = 96000,\n        channelCount = 1,\n        volume = 1.0,\n        sampleSize = 16,\n        opusStereo = false,\n        opusDtx = true,\n        opusFec = true,\n        opusPtime = 20,\n        opusMaxPlaybackRate = 96000\n      } = {};\n\n      if (\n        (restart && this._micProducer) ||\n        start\n      ) {\n        // this.disconnectLocalHark();\n\n        if (this._micProducer)\n          await this.disableMic();\n\n        const stream = await navigator.mediaDevices.getUserMedia(\n          {\n            audio: {\n              deviceId: { ideal: deviceId },\n              sampleRate,\n              channelCount,\n              // @ts-ignore\n              volume,\n              autoGainControl,\n              echoCancellation,\n              noiseSuppression,\n              sampleSize\n            }\n          }\n        );\n\n        ([track] = stream.getAudioTracks());\n\n        const { deviceId: trackDeviceId } = track.getSettings();\n\n        // store.dispatch(settingsActions.setSelectedAudioDevice(trackDeviceId));\n\n        this._micProducer = await this._sendTransport.produce(\n          {\n            track,\n            codecOptions:\n            {\n              opusStereo,\n              opusDtx,\n              opusFec,\n              opusPtime,\n              opusMaxPlaybackRate\n            },\n            appData:\n              { source: 'mic' }\n          });\n\n        // store.dispatch(producerActions.addProducer(\n        //   {\n        //     id: this._micProducer.id,\n        //     source: 'mic',\n        //     paused: this._micProducer.paused,\n        //     track: this._micProducer.track,\n        //     rtpParameters: this._micProducer.rtpParameters,\n        //     codec: this._micProducer.rtpParameters.codecs[0].mimeType.split('/')[1]\n        //   }));\n\n        this._micProducer.on('transportclose', () => {\n          this._micProducer = null;\n        });\n\n        this._micProducer.on('trackended', () => {\n          // store.dispatch(requestActions.notify(\n          //   {\n          //     type: 'error',\n          //     text: intl.formatMessage({\n          //       id: 'devices.microphoneDisconnected',\n          //       defaultMessage: 'Microphone disconnected'\n          //     })\n          //   }));\n\n          this.disableMic();\n        });\n\n        this._micProducer.volume = 0;\n\n        // this.connectLocalHark(track);\n      }\n      else if (this._micProducer) {\n        ({ track } = this._micProducer);\n\n        await track.applyConstraints(\n          {\n            sampleRate,\n            channelCount,\n            volume,\n            autoGainControl,\n            echoCancellation,\n            noiseSuppression,\n            sampleSize\n          }\n        );\n\n        if (this._harkStream != null) {\n          const [harkTrack] = this._harkStream.getAudioTracks();\n\n          harkTrack && await harkTrack.applyConstraints(\n            {\n              sampleRate,\n              channelCount,\n              volume,\n              autoGainControl,\n              echoCancellation,\n              noiseSuppression,\n              sampleSize\n            }\n          );\n        }\n      }\n\n      await this._updateAudioDevices();\n    }\n    catch (error) {\n      this.logger.error('updateMic() [error:\"%o\"]', error);\n\n      // store.dispatch(requestActions.notify(\n      //   {\n      //     type: 'error',\n      //     text: intl.formatMessage({\n      //       id: 'devices.microphoneError',\n      //       defaultMessage: 'An error occurred while accessing your microphone'\n      //     })\n      //   }));\n\n      if (track)\n        track.stop();\n    }\n\n    // store.dispatch(meActions.setAudioInProgress(false));\n  }\n\n  async updateWebcam({\n    init = false,\n    start = false,\n    restart = false,\n    newDeviceId = null,\n    newResolution = null,\n    newFrameRate = null\n  } = {}) {\n    this.logger.debug(\n      'updateWebcam() [start:\"%s\", restart:\"%s\", newDeviceId:\"%s\", newResolution:\"%s\", newFrameRate:\"%s\"]',\n      start,\n      restart,\n      newDeviceId,\n      newResolution,\n      newFrameRate\n    );\n\n    let track;\n\n    try {\n      if (!this._mediasoupDevice.canProduce('video'))\n        throw new Error('cannot produce video');\n\n      if (newDeviceId && !restart)\n        throw new Error('changing device requires restart');\n\n      // if (newDeviceId)\n      //   store.dispatch(settingsActions.setSelectedWebcamDevice(newDeviceId));\n\n      // if (newResolution)\n      //   store.dispatch(settingsActions.setVideoResolution(newResolution));\n\n      // if (newFrameRate)\n      //   store.dispatch(settingsActions.setVideoFrameRate(newFrameRate));\n\n      const  videoMuted  = false\n\n      if (init && videoMuted)\n        return;\n      // else\n        // store.dispatch(settingsActions.setVideoMuted(false));\n\n      // store.dispatch(meActions.setWebcamInProgress(true));\n\n      const deviceId = await this._getWebcamDeviceId();\n      const device = this._webcams[deviceId];\n\n      if (!device)\n        throw new Error('no webcam devices');\n\n      const  resolution = 'medium'\n      const frameRate = 15\n\n\n\n      if (\n        (restart && this._webcamProducer) ||\n        start\n      ) {\n        if (this._webcamProducer)\n          await this.disableWebcam();\n\n        const stream = await navigator.mediaDevices.getUserMedia(\n          {\n            video:\n            {\n              deviceId: { ideal: deviceId },\n              ...VIDEO_CONSTRAINS[resolution],\n              frameRate\n            }\n          });\n\n        ([track] = stream.getVideoTracks());\n\n        const { deviceId: trackDeviceId } = track.getSettings();\n\n        // store.dispatch(settingsActions.setSelectedWebcamDevice(trackDeviceId));\n\n        if (this._useSimulcast) {\n          // If VP9 is the only available video codec then use SVC.\n          const firstVideoCodec = this._mediasoupDevice\n            .rtpCapabilities\n            .codecs\n            .find((c) => c.kind === 'video');\n\n          let encodings;\n\n          if (firstVideoCodec.mimeType.toLowerCase() === 'video/vp9')\n            encodings = VIDEO_KSVC_ENCODINGS;\n          else if (simulcastEncodings)\n            encodings = simulcastEncodings;\n          else\n            encodings = VIDEO_SIMULCAST_ENCODINGS;\n\n          this._webcamProducer = await this._sendTransport.produce(\n            {\n              track,\n              encodings,\n              codecOptions:\n              {\n                videoGoogleStartBitrate: 1000\n              },\n              appData:\n              {\n                source: 'webcam'\n              }\n            });\n        }\n        else {\n          this._webcamProducer = await this._sendTransport.produce({\n            track,\n            appData:\n            {\n              source: 'webcam'\n            }\n          });\n        }\n\n        // store.dispatch(producerActions.addProducer(\n        //   {\n        //     id: this._webcamProducer.id,\n        //     source: 'webcam',\n        //     paused: this._webcamProducer.paused,\n        //     track: this._webcamProducer.track,\n        //     rtpParameters: this._webcamProducer.rtpParameters,\n        //     codec: this._webcamProducer.rtpParameters.codecs[0].mimeType.split('/')[1]\n        //   }));\n\n\n        const webCamStream = new Stream()\n        webCamStream.setProducer(this._webcamProducer);\n\n        this.onCamProducing.next(webCamStream)\n\n        this._webcamProducer.on('transportclose', () => {\n          this._webcamProducer = null;\n        });\n\n        this._webcamProducer.on('trackended', () => {\n          // store.dispatch(requestActions.notify(\n          //   {\n          //     type: 'error',\n          //     text: intl.formatMessage({\n          //       id: 'devices.cameraDisconnected',\n          //       defaultMessage: 'Camera disconnected'\n          //     })\n          //   }));\n\n          this.disableWebcam();\n        });\n      }\n      else if (this._webcamProducer) {\n        ({ track } = this._webcamProducer);\n\n        await track.applyConstraints(\n          {\n            ...VIDEO_CONSTRAINS[resolution],\n            frameRate\n          }\n        );\n\n        // Also change resolution of extra video producers\n        for (const producer of this._extraVideoProducers.values()) {\n          ({ track } = producer);\n\n          await track.applyConstraints(\n            {\n              ...VIDEO_CONSTRAINS[resolution],\n              frameRate\n            }\n          );\n        }\n      }\n\n      await this._updateWebcams();\n    }\n    catch (error) {\n      this.logger.error('updateWebcam() [error:\"%o\"]', error);\n\n      // store.dispatch(requestActions.notify(\n      //   {\n      //     type: 'error',\n      //     text: intl.formatMessage({\n      //       id: 'devices.cameraError',\n      //       defaultMessage: 'An error occurred while accessing your camera'\n      //     })\n      //   }));\n\n      if (track)\n        track.stop();\n    }\n\n    // store.dispatch(\n    //   meActions.setWebcamInProgress(false));\n  }\n\n  async closeMeeting() {\n    this.logger.debug('closeMeeting()');\n\n    // store.dispatch(\n    //   roomActions.setCloseMeetingInProgress(true));\n\n    try {\n      await this.signalingService.sendRequest('moderator:closeMeeting');\n    }\n    catch (error) {\n      this.logger.error('closeMeeting() [error:\"%o\"]', error);\n    }\n\n    // store.dispatch(\n    //   roomActions.setCloseMeetingInProgress(false));\n  }\n\n  // // type: mic/webcam/screen\n  // // mute: true/false\n  async modifyPeerConsumer(peerId, type, mute) {\n    this.logger.debug(\n      'modifyPeerConsumer() [peerId:\"%s\", type:\"%s\"]',\n      peerId,\n      type\n    );\n\n    // if (type === 'mic')\n    //   store.dispatch(\n    //     peerActions.setPeerAudioInProgress(peerId, true));\n    // else if (type === 'webcam')\n    //   store.dispatch(\n    //     peerActions.setPeerVideoInProgress(peerId, true));\n    // else if (type === 'screen')\n    //   store.dispatch(\n    //     peerActions.setPeerScreenInProgress(peerId, true));\n\n    try {\n      for (const consumer of this._consumers.values()) {\n        if (consumer.appData.peerId === peerId && consumer.appData.source === type) {\n          if (mute)\n            await this._pauseConsumer(consumer);\n          else\n            await this._resumeConsumer(consumer);\n        }\n      }\n    }\n    catch (error) {\n      this.logger.error('modifyPeerConsumer() [error:\"%o\"]', error);\n    }\n\n    // if (type === 'mic')\n    //   store.dispatch(\n    //     peerActions.setPeerAudioInProgress(peerId, false));\n    // else if (type === 'webcam')\n    //   store.dispatch(\n    //     peerActions.setPeerVideoInProgress(peerId, false));\n    // else if (type === 'screen')\n    //   store.dispatch(\n    //     peerActions.setPeerScreenInProgress(peerId, false));\n  }\n\n  async _pauseConsumer(consumer) {\n    this.logger.debug('_pauseConsumer() [consumer:\"%o\"]', consumer);\n\n    if (consumer.paused || consumer.closed)\n      return;\n\n    try {\n      await this.signalingService.sendRequest('pauseConsumer', { consumerId: consumer.id });\n\n      consumer.pause();\n\n      // store.dispatch(\n      //   consumerActions.setConsumerPaused(consumer.id, 'local'));\n    }\n    catch (error) {\n      this.logger.error('_pauseConsumer() [error:\"%o\"]', error);\n    }\n  }\n\n  async _resumeConsumer(consumer) {\n    this.logger.debug('_resumeConsumer() [consumer:\"%o\"]', consumer);\n\n    if (!consumer.paused || consumer.closed)\n      return;\n\n    try {\n      await this.signalingService.sendRequest('resumeConsumer', { consumerId: consumer.id });\n\n      consumer.resume();\n\n      // store.dispatch(\n      //   consumerActions.setConsumerResumed(consumer.id, 'local'));\n    }\n    catch (error) {\n      this.logger.error('_resumeConsumer() [error:\"%o\"]', error);\n    }\n  }\n\n  // async setMaxSendingSpatialLayer(spatialLayer) {\n  //   logger.debug('setMaxSendingSpatialLayer() [spatialLayer:\"%s\"]', spatialLayer);\n\n  //   try {\n  //     if (this._webcamProducer)\n  //       await this._webcamProducer.setMaxSpatialLayer(spatialLayer);\n  //     if (this._screenSharingProducer)\n  //       await this._screenSharingProducer.setMaxSpatialLayer(spatialLayer);\n  //   }\n  //   catch (error) {\n  //     logger.error('setMaxSendingSpatialLayer() [error:\"%o\"]', error);\n  //   }\n  // }\n\n  // async setConsumerPreferredLayers(consumerId, spatialLayer, temporalLayer) {\n  //   logger.debug(\n  //     'setConsumerPreferredLayers() [consumerId:\"%s\", spatialLayer:\"%s\", temporalLayer:\"%s\"]',\n  //     consumerId, spatialLayer, temporalLayer);\n\n  //   try {\n  //     await this.sendRequest(\n  //       'setConsumerPreferedLayers', { consumerId, spatialLayer, temporalLayer });\n\n  //     store.dispatch(consumerActions.setConsumerPreferredLayers(\n  //       consumerId, spatialLayer, temporalLayer));\n  //   }\n  //   catch (error) {\n  //     logger.error('setConsumerPreferredLayers() [error:\"%o\"]', error);\n  //   }\n  // }\n\n  // async setConsumerPriority(consumerId, priority) {\n  //   logger.debug(\n  //     'setConsumerPriority() [consumerId:\"%s\", priority:%d]',\n  //     consumerId, priority);\n\n  //   try {\n  //     await this.sendRequest('setConsumerPriority', { consumerId, priority });\n\n  //     store.dispatch(consumerActions.setConsumerPriority(consumerId, priority));\n  //   }\n  //   catch (error) {\n  //     logger.error('setConsumerPriority() [error:\"%o\"]', error);\n  //   }\n  // }\n\n  // async requestConsumerKeyFrame(consumerId) {\n  //   logger.debug('requestConsumerKeyFrame() [consumerId:\"%s\"]', consumerId);\n\n  //   try {\n  //     await this.sendRequest('requestConsumerKeyFrame', { consumerId });\n  //   }\n  //   catch (error) {\n  //     logger.error('requestConsumerKeyFrame() [error:\"%o\"]', error);\n  //   }\n  // }\n\n\n\n\n  async join({ roomId, joinVideo, joinAudio }) {\n\n\n    this._roomId = roomId;\n\n\n    // initialize signaling socket\n    // listen to socket events\n    this.signalingService.init(roomId, this._peerId)\n    this.signalingService.onDisconnected.subscribe( () => {\n      // close\n      // this.close\n    })\n    this.signalingService.onReconnecting.subscribe( () => {\n      // close\n\n\n\n\n\t\t\tif (this._webcamProducer)\n\t\t\t{\n\t\t\t\tthis._webcamProducer.close();\n\n\t\t\t\t// store.dispatch(\n\t\t\t\t// \tproducerActions.removeProducer(this._webcamProducer.id));\n\n\t\t\t\tthis._webcamProducer = null;\n\t\t\t}\n\n\t\t\tif (this._micProducer)\n\t\t\t{\n\t\t\t\tthis._micProducer.close();\n\n\t\t\t\t// store.dispatch(\n\t\t\t\t// \tproducerActions.removeProducer(this._micProducer.id));\n\n\t\t\t\tthis._micProducer = null;\n\t\t\t}\n\n\t\t\tif (this._sendTransport)\n\t\t\t{\n\t\t\t\tthis._sendTransport.close();\n\n\t\t\t\tthis._sendTransport = null;\n\t\t\t}\n\n\t\t\tif (this._recvTransport)\n\t\t\t{\n\t\t\t\tthis._recvTransport.close();\n\n\t\t\t\tthis._recvTransport = null;\n\t\t\t}\n\n      this.remotePeersService.clearPeers();\n\n\n\t\t\t// store.dispatch(roomActions.setRoomState('connecting'));\n    })\n\n    this.signalingService.onNewConsumer.pipe(switchMap(async (data) => {\n      const {\n        peerId,\n        producerId,\n        id,\n        kind,\n        rtpParameters,\n        type,\n        appData,\n        producerPaused\n      } = data;\n\n      const consumer  = await this._recvTransport.consume(\n        {\n          id,\n          producerId,\n          kind,\n          rtpParameters,\n          appData : { ...appData, peerId } // Trick.\n        }) as mediasoupClient.types.Consumer;\n\n      // Store in the map.\n      this._consumers.set(consumer.id, consumer);\n\n      consumer.on('transportclose', () =>\n      {\n        this._consumers.delete(consumer.id);\n      });\n\n\n\n\n      this.remotePeersService.newConsumer(consumer,  peerId, type, producerPaused);\n\n      // We are ready. Answer the request so the server will\n      // resume this Consumer (which was paused for now).\n\n\n      // if (kind === 'audio')\n      // {\n      //   consumer.volume = 0;\n\n      //   const stream = new MediaStream();\n\n      //   stream.addTrack(consumer.track);\n\n      //   if (!stream.getAudioTracks()[0])\n      //     throw new Error('request.newConsumer | given stream has no audio track');\n\n        // consumer.hark = hark(stream, { play: false });\n\n        // consumer.hark.on('volume_change', (volume) =>\n        // {\n        //   volume = Math.round(volume);\n\n        //   if (consumer && volume !== consumer.volume)\n        //   {\n        //     consumer.volume = volume;\n\n        //     // store.dispatch(peerVolumeActions.setPeerVolume(peerId, volume));\n        //   }\n        // });\n      // }\n\n    })).subscribe()\n\n    this.signalingService.onNotification.pipe(switchMap(async (notification) => {\n      this.logger.debug(\n        'socket \"notification\" event [method:\"%s\", data:\"%o\"]',\n        notification.method, notification.data);\n\n      try {\n        switch (notification.method) {\n\n\n\n          case 'producerScore':\n            {\n              const { producerId, score } = notification.data;\n\n              // store.dispatch(\n              //   producerActions.setProducerScore(producerId, score));\n\n              break;\n            }\n\n          case 'newPeer':\n            {\n              const { id, displayName, picture, roles } = notification.data;\n\n              // store.dispatch(peerActions.addPeer(\n              //   { id, displayName, picture, roles, consumers: [] }));\n\n              this.remotePeersService.newPeer(id);\n\n              // this._soundNotification();\n\n              // store.dispatch(requestActions.notify(\n              //   {\n              //     text: intl.formatMessage({\n              //       id: 'room.newPeer',\n              //       defaultMessage: '{displayName} joined the room'\n              //     }, {\n              //       displayName\n              //     })\n              //   }));\n\n              break;\n            }\n\n          case 'peerClosed':\n            {\n              const { peerId } = notification.data;\n\n              this.remotePeersService.closePeer(peerId);\n\n              // store.dispatch(\n              //   peerActions.removePeer(peerId));\n\n              break;\n            }\n\n          case 'consumerClosed':\n            {\n              const { consumerId } = notification.data;\n              const consumer = this._consumers.get(consumerId);\n\n              if (!consumer)\n                break;\n\n              consumer.close();\n\n              if (consumer.hark != null)\n                consumer.hark.stop();\n\n              this._consumers.delete(consumerId);\n\n              const { peerId } = consumer.appData;\n\n              // store.dispatch(\n              //   consumerActions.removeConsumer(consumerId, peerId));\n\n              break;\n            }\n\n          case 'consumerPaused':\n            {\n              const { consumerId } = notification.data;\n              const consumer = this._consumers.get(consumerId);\n\n              if (!consumer)\n                break;\n\n              // store.dispatch(\n              //   consumerActions.setConsumerPaused(consumerId, 'remote'));\n\n              break;\n            }\n\n          case 'consumerResumed':\n            {\n              const { consumerId } = notification.data;\n              const consumer = this._consumers.get(consumerId);\n\n              if (!consumer)\n                break;\n\n              // store.dispatch(\n              //   consumerActions.setConsumerResumed(consumerId, 'remote'));\n\n              break;\n            }\n\n          case 'consumerLayersChanged':\n            {\n              const { consumerId, spatialLayer, temporalLayer } = notification.data;\n              const consumer = this._consumers.get(consumerId);\n\n              if (!consumer)\n                break;\n\n              this.remotePeersService.onConsumerLayerChanged(consumerId)\n              // store.dispatch(consumerActions.setConsumerCurrentLayers(\n              //   consumerId, spatialLayer, temporalLayer));\n\n              break;\n            }\n\n          case 'consumerScore':\n            {\n              const { consumerId, score } = notification.data;\n\n              // store.dispatch(\n              //   consumerActions.setConsumerScore(consumerId, score));\n\n              break;\n            }\n            case 'roomBack':\n              {\n                await this._joinRoom({ joinVideo, joinAudio });\n\n                break;\n              }\n\n              case 'roomReady':\n                {\n                  const { turnServers } = notification.data;\n\n                  this._turnServers = turnServers;\n\n                  // store.dispatch(roomActions.toggleJoined());\n                  // store.dispatch(roomActions.setInLobby(false));\n\n                  await this._joinRoom({ joinVideo, joinAudio });\n\n                  break;\n                }\n          default:\n            {\n              // this.logger.error(\n              //   'unknown notification.method \"%s\"', notification.method);\n            }\n        }\n      }\n      catch (error) {\n        this.logger.error('error on socket \"notification\" event [error:\"%o\"]', error);\n\n        // store.dispatch(requestActions.notify(\n        //   {\n        //     type: 'error',\n        //     text: intl.formatMessage({\n        //       id: 'socket.requestError',\n        //       defaultMessage: 'Error on server request'\n        //     })\n        //   }));\n      }\n\n    })).subscribe()\n    // on room ready join room _joinRoom\n\n    // this._mediasoupDevice = new mediasoupClient.Device();\n\n    // const routerRtpCapabilities =\n    //   await this.sendRequest('getRouterRtpCapabilities');\n\n    // routerRtpCapabilities.headerExtensions = routerRtpCapabilities.headerExtensions\n    //   .filter((ext) => ext.uri !== 'urn:3gpp:video-orientation');\n\n    // await this._mediasoupDevice.load({ routerRtpCapabilities });\n\n    // create send transport createWebRtcTransport this.signalingService.sendCreateTransport\n    // listen to transport events\n\n    // create receive transport this.signalingService.sendCreateTranspor\n    // listen to transport events\n\n    // send join request\n\n    // add peers to peers service\n\n    // produce updateWebcam updateMic\n  }\n\n\n\tasync _updateAudioDevices()\n\t{\n\t\tthis.logger.debug('_updateAudioDevices()');\n\n\t\t// Reset the list.\n\t\tthis._audioDevices = {};\n\n\t\ttry\n\t\t{\n\t\t\tthis.logger.debug('_updateAudioDevices() | calling enumerateDevices()');\n\n\t\t\tconst devices = await navigator.mediaDevices.enumerateDevices();\n\n\t\t\tfor (const device of devices)\n\t\t\t{\n\t\t\t\tif (device.kind !== 'audioinput')\n\t\t\t\t\tcontinue;\n\n\t\t\t\tthis._audioDevices[device.deviceId] = device;\n\t\t\t}\n\n\t\t\t// store.dispatch(\n\t\t\t// \tmeActions.setAudioDevices(this._audioDevices));\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tthis.logger.error('_updateAudioDevices() [error:\"%o\"]', error);\n\t\t}\n\t}\n\n\tasync _updateWebcams()\n\t{\n\t\tthis.logger.debug('_updateWebcams()');\n\n\t\t// Reset the list.\n\t\tthis._webcams = {};\n\n\t\ttry\n\t\t{\n\t\t\tthis.logger.debug('_updateWebcams() | calling enumerateDevices()');\n\n\t\t\tconst devices = await navigator.mediaDevices.enumerateDevices();\n\n\t\t\tfor (const device of devices)\n\t\t\t{\n\t\t\t\tif (device.kind !== 'videoinput')\n\t\t\t\t\tcontinue;\n\n\t\t\t\tthis._webcams[device.deviceId] = device;\n\t\t\t}\n\n\t\t\t// store.dispatch(\n\t\t\t// \tmeActions.setWebcamDevices(this._webcams));\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tthis.logger.error('_updateWebcams() [error:\"%o\"]', error);\n\t\t}\n\t}\n\n\tasync disableWebcam()\n\t{\n\t\tthis.logger.debug('disableWebcam()');\n\n\t\tif (!this._webcamProducer)\n\t\t\treturn;\n\n\t\t// store.dispatch(meActions.setWebcamInProgress(true));\n\n\t\tthis._webcamProducer.close();\n\n\t\t// store.dispatch(\n\t\t// \tproducerActions.removeProducer(this._webcamProducer.id));\n\n\t\ttry\n\t\t{\n\t\t\tawait this.signalingService.sendRequest(\n\t\t\t\t'closeProducer', { producerId: this._webcamProducer.id });\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tthis.logger.error('disableWebcam() [error:\"%o\"]', error);\n\t\t}\n\n\t\tthis._webcamProducer = null;\n\t\t// store.dispatch(settingsActions.setVideoMuted(true));\n\t\t// store.dispatch(meActions.setWebcamInProgress(false));\n\t}\n\tasync disableMic()\n\t{\n\t\tthis.logger.debug('disableMic()');\n\n\t\tif (!this._micProducer)\n\t\t\treturn;\n\n\t\t// store.dispatch(meActions.setAudioInProgress(true));\n\n\t\tthis._micProducer.close();\n\n\t\t// store.dispatch(\n\t\t// \tproducerActions.removeProducer(this._micProducer.id));\n\n\t\ttry\n\t\t{\n\t\t\tawait this.signalingService.sendRequest(\n\t\t\t\t'closeProducer', { producerId: this._micProducer.id });\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tthis.logger.error('disableMic() [error:\"%o\"]', error);\n\t\t}\n\n\t\tthis._micProducer = null;\n\n\t\t// store.dispatch(meActions.setAudioInProgress(false));\n  }\n\n\n\tasync _getWebcamDeviceId()\n\t{\n\t\tthis.logger.debug('_getWebcamDeviceId()');\n\n\t\ttry\n\t\t{\n\t\t\tthis.logger.debug('_getWebcamDeviceId() | calling _updateWebcams()');\n\n\t\t\tawait this._updateWebcams();\n\n\t\t\tconst  selectedWebcam =  null\n\n\t\t\tif (selectedWebcam && this._webcams[selectedWebcam])\n\t\t\t\treturn selectedWebcam;\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst webcams = Object.values(this._webcams);\n\n        // @ts-ignore\n\t\t\t\treturn webcams[0] ? webcams[0].deviceId : null;\n\t\t\t}\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tthis.logger.error('_getWebcamDeviceId() [error:\"%o\"]', error);\n\t\t}\n  }\n\n\n\tasync _getAudioDeviceId()\n\t{\n\t\tthis.logger.debug('_getAudioDeviceId()');\n\n\t\ttry\n\t\t{\n\t\t\tthis.logger.debug('_getAudioDeviceId() | calling _updateAudioDeviceId()');\n\n\t\t\tawait this._updateAudioDevices();\n\n      const  selectedAudioDevice = null;\n\n\t\t\tif (selectedAudioDevice && this._audioDevices[selectedAudioDevice])\n\t\t\t\treturn selectedAudioDevice;\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst audioDevices = Object.values(this._audioDevices);\n\n        // @ts-ignore\n\t\t\t\treturn audioDevices[0] ? audioDevices[0].deviceId : null;\n\t\t\t}\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tthis.logger.error('_getAudioDeviceId() [error:\"%o\"]', error);\n\t\t}\n\t}\n\n\tasync _updateAudioOutputDevices()\n\t{\n\t\tthis.logger.debug('_updateAudioOutputDevices()');\n\n\t\t// Reset the list.\n\t\tthis._audioOutputDevices = {};\n\n\t\ttry\n\t\t{\n\t\t\tthis.logger.debug('_updateAudioOutputDevices() | calling enumerateDevices()');\n\n\t\t\tconst devices = await navigator.mediaDevices.enumerateDevices();\n\n\t\t\tfor (const device of devices)\n\t\t\t{\n\t\t\t\tif (device.kind !== 'audiooutput')\n\t\t\t\t\tcontinue;\n\n\t\t\t\tthis._audioOutputDevices[device.deviceId] = device;\n\t\t\t}\n\n\t\t\t// store.dispatch(\n\t\t\t// \tmeActions.setAudioOutputDevices(this._audioOutputDevices));\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tthis.logger.error('_updateAudioOutputDevices() [error:\"%o\"]', error);\n\t\t}\n\t}\n\n\n\n  async _joinRoom({ joinVideo, joinAudio }) {\n    this.logger.debug('_joinRoom()');\n\n    const displayName = `Guest ${Math.floor(Math.random() * (100000 - 10000)) + 10000}`\n\n\n    try {\n\n\n      this._mediasoupDevice = new mediasoupClient.Device();\n\n      const routerRtpCapabilities =\n        await this.signalingService.sendRequest('getRouterRtpCapabilities');\n\n      routerRtpCapabilities.headerExtensions = routerRtpCapabilities.headerExtensions\n        .filter((ext) => ext.uri !== 'urn:3gpp:video-orientation');\n\n      await this._mediasoupDevice.load({ routerRtpCapabilities });\n\n      if (this._produce) {\n        const transportInfo = await this.signalingService.sendRequest(\n          'createWebRtcTransport',\n          {\n            forceTcp: this._forceTcp,\n            producing: true,\n            consuming: false\n          });\n\n        const {\n          id,\n          iceParameters,\n          iceCandidates,\n          dtlsParameters\n        } = transportInfo;\n\n        this._sendTransport = this._mediasoupDevice.createSendTransport(\n          {\n            id,\n            iceParameters,\n            iceCandidates,\n            dtlsParameters,\n            iceServers: this._turnServers,\n            // TODO: Fix for issue #72\n            iceTransportPolicy: this._device.flag === 'firefox' && this._turnServers ? 'relay' : undefined,\n            proprietaryConstraints: PC_PROPRIETARY_CONSTRAINTS\n          });\n\n        this._sendTransport.on(\n          'connect', ({ dtlsParameters }, callback, errback) => // eslint-disable-line no-shadow\n        {\n          this.signalingService.sendRequest(\n            'connectWebRtcTransport',\n            {\n              transportId: this._sendTransport.id,\n              dtlsParameters\n            })\n            .then(callback)\n            .catch(errback);\n        });\n\n        this._sendTransport.on(\n          'produce', async ({ kind, rtpParameters, appData }, callback, errback) => {\n          try {\n            // eslint-disable-next-line no-shadow\n            const { id } = await this.signalingService.sendRequest(\n              'produce',\n              {\n                transportId: this._sendTransport.id,\n                kind,\n                rtpParameters,\n                appData\n              });\n\n            callback({ id });\n          }\n          catch (error) {\n            errback(error);\n          }\n        });\n      }\n\n      const transportInfo = await this.signalingService.sendRequest(\n        'createWebRtcTransport',\n        {\n          forceTcp: this._forceTcp,\n          producing: false,\n          consuming: true\n        });\n\n      const {\n        id,\n        iceParameters,\n        iceCandidates,\n        dtlsParameters\n      } = transportInfo;\n\n      this._recvTransport = this._mediasoupDevice.createRecvTransport(\n        {\n          id,\n          iceParameters,\n          iceCandidates,\n          dtlsParameters,\n          iceServers: this._turnServers,\n          // TODO: Fix for issue #72\n          iceTransportPolicy: this._device.flag === 'firefox' && this._turnServers ? 'relay' : undefined\n        });\n\n      this._recvTransport.on(\n        'connect', ({ dtlsParameters }, callback, errback) => // eslint-disable-line no-shadow\n      {\n        this.signalingService.sendRequest(\n          'connectWebRtcTransport',\n          {\n            transportId: this._recvTransport.id,\n            dtlsParameters\n          })\n          .then(callback)\n          .catch(errback);\n      });\n\n      // Set our media capabilities.\n      // store.dispatch(meActions.setMediaCapabilities(\n      // \t{\n      // \t\tcanSendMic     : this._mediasoupDevice.canProduce('audio'),\n      // \t\tcanSendWebcam  : this._mediasoupDevice.canProduce('video'),\n      // \t\tcanShareScreen : this._mediasoupDevice.canProduce('video') &&\n      // \t\t\tthis._screenSharing.isScreenShareAvailable(),\n      // \t\tcanShareFiles : this._torrentSupport\n      // \t}));\n\n      const {\n        authenticated,\n        roles,\n        peers,\n        tracker,\n        roomPermissions,\n        userRoles,\n        allowWhenRoleMissing,\n        chatHistory,\n        fileHistory,\n        lastNHistory,\n        locked,\n        lobbyPeers,\n        accessCode\n      } = await this.signalingService.sendRequest(\n        'join',\n        {\n          displayName: displayName,\n\n          rtpCapabilities: this._mediasoupDevice.rtpCapabilities\n        });\n\n      this.logger.debug(\n        '_joinRoom() joined [authenticated:\"%s\", peers:\"%o\", roles:\"%o\", userRoles:\"%o\"]',\n        authenticated,\n        peers,\n        roles,\n        userRoles\n      );\n\n\n\n\n\n      // for (const peer of peers)\n      // {\n      // \tstore.dispatch(\n      // \t\tpeerActions.addPeer({ ...peer, consumers: [] }));\n      // }\n\n        this.logger.debug('join audio',joinAudio , 'can produce audio',\n          this._mediasoupDevice.canProduce('audio'), ' this._muted', this._muted)\n      // Don't produce if explicitly requested to not to do it.\n      if (this._produce) {\n        if (\n          joinVideo\n        ) {\n          this.updateWebcam({ init: true, start: true });\n        }\n        if (\n          joinAudio &&\n          this._mediasoupDevice.canProduce('audio')\n        )\n          if (!this._muted) {\n            await this.updateMic({ start: true });\n\n          }\n      }\n\n      await this._updateAudioOutputDevices();\n\n      // const  selectedAudioOutputDevice  = null\n\n      // if (!selectedAudioOutputDevice && this._audioOutputDevices !== {})\n      // {\n      // \tstore.dispatch(\n      // \t\tsettingsActions.setSelectedAudioOutputDevice(\n      // \t\t\tObject.keys(this._audioOutputDevices)[0]\n      // \t\t)\n      // \t);\n      // }\n\n      // store.dispatch(roomActions.setRoomState('connected'));\n\n      // // Clean all the existing notifications.\n      // store.dispatch(notificationActions.removeAllNotifications());\n\n      // store.dispatch(requestActions.notify(\n      // \t{\n      // \t\ttext : intl.formatMessage({\n      // \t\t\tid             : 'room.joined',\n      // \t\t\tdefaultMessage : 'You have joined the room'\n      // \t\t})\n      // \t}));\n\n      this.remotePeersService.addPeers(peers);\n\n\n    }\n    catch (error) {\n      this.logger.error('_joinRoom() [error:\"%o\"]', error);\n\n\n      this.close();\n    }\n  }\n  deviceInfo() {\n    const ua = navigator.userAgent;\n    const browser = bowser.getParser(ua);\n\n    let flag;\n\n    if (browser.satisfies({ chrome: '>=0', chromium: '>=0' }))\n      flag = 'chrome';\n    else if (browser.satisfies({ firefox: '>=0' }))\n      flag = 'firefox';\n    else if (browser.satisfies({ safari: '>=0' }))\n      flag = 'safari';\n    else if (browser.satisfies({ opera: '>=0' }))\n      flag = 'opera';\n    else if (browser.satisfies({ 'microsoft edge': '>=0' }))\n      flag = 'edge';\n    else\n      flag = 'unknown';\n\n    return {\n      flag,\n      os: browser.getOSName(true), // ios, android, linux...\n      platform: browser.getPlatformType(true), // mobile, desktop, tablet\n      name: browser.getBrowserName(true),\n      version: browser.getBrowserVersion(),\n      bowser: browser\n    };\n\n  }\n}\n"],"names":["i0.elementStart","i0.text","i0.elementEnd","Component","LogService","LoggerModule","NgxLoggerLevel","NgModule","Subject","io","Injectable","BehaviorSubject","switchMap","mediasoupClient.Device"],"mappings":"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"}